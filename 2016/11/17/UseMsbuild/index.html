<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Use v90(VS2008) to build projects in VS2015 solution | Kover's loft</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Use v90(VS2008) to build projects in VS2015 solution</h1><a id="logo" href="/.">Kover's loft</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Use v90(VS2008) to build projects in VS2015 solution</h1><div class="post-meta">Nov 17, 2016<span> | </span><span class="category"><a href="/categories/C-C/">C/C++</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2016/11/17/UseMsbuild/" href="/2016/11/17/UseMsbuild/#comments" class="ds-thread-count"></a><div class="post-content"><p>If we build a vs2015 solution for the new project which will communicate with the old projects which are built with vs2008, there will be some problems happened when using STL as the interfaces. Because the STL in vs2015 is not capatible with the one in vs2008.<br>vs2015 is more convenience for debugging and it’s intellisense is better, I prefer to work on it. So I should use v90 which is the toolset of vs2008 to build projects in vs2015. I find 2 ways(<em>both of them need to install vs2008 and vs2015</em>) to do this.  </p>
<h3 id="1-Use-platform-toolset-v90"><a href="#1-Use-platform-toolset-v90" class="headerlink" title="1. Use platform toolset v90"></a>1. Use platform toolset v90</h3><p>If you only install vs2008 and vs2015, no metter which order, you may can not see the v90 in the Platform Toolset.<br>There are 2 ways I found on the Internet:</p>
<ol>
<li>Install vs2010</li>
<li><p>Install windows SDK7.1. If failed, open the Setup folder, install the .msi file in vc_stdamd64, vc_stdx86 and WinSDKBuild_amd64.</p>
<p>I prefer the first way. The package of vs2010 is large, but there is no problem when install it, and it works well. I wasted much time on the second way and failed at last.<br>But there is a serious problem after I choose the v90 as the platform toolset, the intellisense does not work. I don’t know how to fix it, so I find another way.</p>
<h3 id="2-Use-cmake-and-msbuild"><a href="#2-Use-cmake-and-msbuild" class="headerlink" title="2. Use cmake and msbuild"></a>2. Use cmake and msbuild</h3></li>
<li>Install <a href="https://cmake.org/" target="_blank" rel="external">cmake</a> </li>
<li>Write a CMakeLists for the project</li>
<li>Choose the Configuration Type to Makefile</li>
<li>Add Build Command Line in the NMake<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">CMake --Build ..\Build2008</div><div class="line">MSBuild ..\Build2008\GPU2015.sln /p:Platform=x64</div><div class="line">copy ..\Build2008\Debug\gpu.dll ..\..\..\..\lib\</div></pre></td></tr></table></figure>
</li>
</ol>
<p>When this project is built, these commands will be executed. Firstly using cmake to generate a vs2008 solution, then using msbuild to build this solution, and copy the binary to the destination at last.</p>
<p>By the second way, I can working on vs2015 daily, and only need update the CMakeLists at low frequency.</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yoursite.com/2016/11/17/UseMsbuild/" data-id="ciznesmmm0004m4oi9l00j9td" class="article-share-link">Share</a><div class="tags"><a href="/tags/VS/">VS</a></div><div class="post-nav"><a href="/2017/02/23/MultiThread/" class="pre">Boost MultiThread learning notes</a><a href="/2016/10/14/GPGPU-0/" class="next">GPGPU-sim code reading notes</a></div><div data-thread-key="2016/11/17/UseMsbuild/" data-title="Use v90(VS2008) to build projects in VS2015 solution" data-url="http://yoursite.com/2016/11/17/UseMsbuild/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2016/11/17/UseMsbuild/" data-title="Use v90(VS2008) to build projects in VS2015 solution" data-url="http://yoursite.com/2016/11/17/UseMsbuild/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/C-C/">C/C++</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ParallelComputing/">ParallelComputing</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/sitelog/">sitelog</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/VS/" style="font-size: 15px;">VS</a> <a href="/tags/GPU/" style="font-size: 15px;">GPU</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/02/23/MultiThread/">Boost MultiThread learning notes</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/17/UseMsbuild/">Use v90(VS2008) to build projects in VS2015 solution</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/14/GPGPU-0/">GPGPU-sim code reading notes</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/01/NotesAboutDllAndLib/">Notes about dll and lib</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/31/Welcome/">Welcome to my blog</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> Recent Comments</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Blogroll</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Kover's loft.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'61f'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>